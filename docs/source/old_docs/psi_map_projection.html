<html>
<meta charset="utf-8"/>
<style>
.def {color: red}
tr:nth-child(even) {background-color: #fff6ff}
tr:nth-child(odd)  {background-color: #fffff6}
</style>
<body>

<p><table cellpadding=10>
<tr><th>Method<th>Description<th>Example
<tr><td><h3>_angle</h3><p>(v_1, v_2) <td><p>
        Calculate the angle between two vectors defined as:

            cos(angle) = (v_1 dot v_2)/(||v_1|| * ||v_2||),

        where ||v|| is the length of the vector.

        <p><b>Parameters</b>:
        v1 : 2-x-1 np.array
            Array with x and y of the first vector
        v2 : 2-x-1 np.array
            Array with x and y of the first vector

        <p><b>Returns</b>:
        angle : float
            A float with the angle between the two vectors

 <tr><td><h3>_calculate_angles</h3><p>(v_1_vectors, v_2) <td><p>
    Function for calculating the angles between the normalised psi calculated
    at the divertor and the divertor itself.
    The angle specified is calculated as the magnitude of the angle between the
    normal of the divertor and the normalised psi contour.

    <p><b>Parameters</b>:
    v_1_vectors : n-x-1 list of 2-x-1 np.arrays
        List of vectors of the field-lines close to the divertor interface
    v_2 : 2-x-1 np.array
        Vector for the divertor coordinates

    <p><b>Returns</b>:
    angles : n-x-1 np.array
        Array of angles between the divertor and the normalised psi calculated
        at the divertor.

 <tr><td><h3>_flux_expansion</h3><p>(b_pol, points_omp, points_div) <td><p>
    Function for evaluating the flux expansion, defined as:

        f_x = x_omp*b_pol(x_omp, y_omp)/(x_div*b_pol(x_div, y_div)),

    where x_omp is the radial coordinate at the OMP, y_omp is the vertical
    coordinate at the OMP (usually 0) and x_div and y_div are the corresponding
    coordinates at the divertor.

    <p><b>Parameters</b>:
    b_pol : cherab.core.math.Interpolate2DCubic
        Function for interpolating the poloidal magnetic field from a fiesta
        equilibrium, given an (r, z)-point
    points_omp : 2-x-1 list
        List containing a point at the outboard mid-plane
    points_div : 2-x-1 list
        List containing the point at the corresponding flux surface at the
        divertor.

    <p><b>Returns</b>:
    f_x : float
        The flux expansion at the divertor point specified

 <tr><td><h3>map_psi_omp_to_divertor</h3><p>(x_axis_omp, divertor_coords, fiesta) <td><p>
    Function mapping the normalised psi from the specified coordinates at the
    OMP to the specified coordinates at the divertor. Currently the divertor is
    assumed to be represented by a 1D polynomial function, y = ax + b.

    <p><b>Parameters</b>:
    x_axis_omp : n-x-1 np.array
        Numpy array with the radial coordinates we wish to map at the OMP
    fiesta : Fiesta
        A Fiesta object with the 2D equilibrium we wish to map
    divertor_coords : 2-x-2 np.array
        A 2-x-2 numpy array containg the corner points of the divertor in the
        2D projection

    <p><b>Returns</b>:
    divertor_map : dictionary
        A dictionary containing:
            "R_div" : an n-x-1 array
                with the R-coordinates at the divertor tile
                corresponding to the same psi_n as at the OMP
            "Z_div" : an n-x-1 array
                with the Z-coordinates at the divertor tile
                corresponding to the same psi_n as at the OMP
            "Angles" : an n-x-1 array
                with the angles between the field lines and the divertor tile
                corresponding to the same psi_n as at the OMP
            "Flux_expansion" : an n-x-1 array
                with the flux expasion at the divertor tile
                corresponding to the same psi_n as at the OMP


</table>
</body>
</html>
